<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>함께가게 - AI 상권분석 및 맞춤 정책 추천</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --dark-blue: #0D1B2A;
            --mid-blue: #1B263B;
            --light-blue: #4A90E2;
            --text-light: #E0E1DD;
            --text-muted: #94a3b8; /* slate-400 */
            --success: #27AE60;
            --warning: #F39C12;
            --danger: #E74C3C;
        }
        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Pretendard', sans-serif;
            background-color: var(--dark-blue);
            color: var(--text-light);
            overflow-x: hidden;
            word-break: keep-all;
        }
        #main-header {
            background: transparent;
            transition: background-color 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }
        #main-header.scrolled {
            background: rgba(13, 27, 42, 0.8); /* var(--dark-blue) with opacity */
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        .animate-on-scroll {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        .animate-on-scroll.in-view {
            opacity: 1;
            transform: translateY(0);
        }
        .marquee-content {
            display: flex;
            position: absolute;
            white-space: nowrap;
            will-change: transform;
            animation: marquee 30s linear infinite;
        }
        @keyframes marquee {
            0% { transform: translateX(0%); }
            100% { transform: translateX(-50%); }
        }
        .glass-card {
            background: rgba(27, 38, 59, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(74, 144, 226, 0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .glass-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        .cta-button {
            transition: all 0.3s ease;
        }
        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(74, 144, 226, 0.3), 0 4px 6px -2px rgba(74, 144, 226, 0.2);
        }
        .report-section { margin-bottom: 10px; }
        .report-section-title { font-size: 1.1em; font-weight: 700; text-align: left; margin-bottom: 15px; display: flex; align-items: center; gap: 8px; color: var(--text-light); }
        .report-section-title i { color: var(--light-blue); }
        .growth-matrix { background: rgba(13, 27, 42, 0.7); padding: 20px; border-radius: 15px; text-align: center; }
        .growth-matrix .status { font-size: 1.4em; font-weight: 900; color: var(--warning); margin-bottom: 5px; }
        .growth-matrix .description { color: var(--text-muted); }
        /* --- 수정된 부분: 차트 너비를 100%로 수정하여 레이아웃 안정성 확보 --- */
        .radar-chart-container { position: relative; width: 100%; max-width: 280px; margin: 0 auto; aspect-ratio: 1 / 1; }
        #radarChart { width: 100%; height: 100%; }
        .radar-legend { display: flex; justify-content: center; gap: 20px; margin-top: 15px; font-size: 0.8em; color: var(--text-muted); }
        .legend-item { display: flex; align-items: center; gap: 5px; }
        .legend-color { width: 12px; height: 12px; border-radius: 3px; }
        .factors-chart { display: flex; flex-direction: column; gap: 12px; text-align: left; }
        .factor-bar { display: flex; align-items: center; gap: 10px; }
        .factor-label { width: 100px; font-size: 0.9em; font-weight: 500; flex-shrink: 0; color: var(--text-light); }
        .factor-bar-bg { flex-grow: 1; background: rgba(13, 27, 42, 0.7); border-radius: 5px; height: 22px; overflow: hidden; }
        .factor-bar-fill {
            height: 100%; width: 0; border-radius: 5px; transition: width 1.5s ease-out; display: flex;
            align-items: center; justify-content: flex-end; padding-right: 8px; color: white;
            font-size: 0.8em; font-weight: 700;
        }
        .factor-bar-fill.positive { background-color: var(--success); }
        .factor-bar-fill.negative { background-color: var(--danger); }
        .ai-summary { background: rgba(74, 144, 226, 0.1); padding: 20px; border-radius: 15px; text-align: left; border: 1px solid rgba(74, 144, 226, 0.2); }
        .ai-summary .icon { font-size: 1.5em; color: var(--light-blue); margin-top: 3px; float: left; margin-right: 15px; }
        .ai-summary p { font-size: 0.95em; line-height: 1.7; overflow: hidden; color: var(--text-light); }
        
        #report-slider-container { transition: height 0.4s ease-in-out; }
        .slider-dot {
            cursor: pointer; height: 12px; width: 12px; margin: 0 4px; background-color: rgba(255, 255, 255, 0.3);
            border-radius: 50%; display: inline-block; transition: background-color 0.6s ease;
        }
        .slider-dot.active { background-color: var(--light-blue); }
    </style>
</head>
<body class="antialiased">

    <header id="main-header" class="fixed top-0 left-0 right-0 z-50">
        <div class="container mx-auto px-6 h-16 flex justify-between items-center">
            <a href="#" class="text-xl font-extrabold text-white">함께가게</a>
            <a href="https://forms.gle/pXZiqrfdseMKmwpg6" target="_blank" rel="noopener noreferrer" class="bg-blue-500 text-white font-bold py-2 px-4 rounded-lg text-sm cta-button">
                출시 알림 신청
            </a>
        </div>
    </header>

    <div class="container mx-auto p-6 pt-24 space-y-20 md:space-y-24">

        <header class="text-center py-16 animate-on-scroll">
            <h1 class="text-4xl md:text-5xl font-extrabold mb-4 leading-tight">
                <span class="block">사장님 가게의 경영상태,</span>
                <span class="block">
                    <span class="text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-cyan-300">데이터로 진단</span>해보셨나요?
                </span>
            </h1>
            <p class="text-lg text-slate-300 opacity-90 mb-10">
                함께가게 AI 컨설턴트가 사장님 가게의 문제를 진단하고 꼭 맞는 지원 정책을 찾아드려요.
            </p>
            <div class="grid grid-cols-3 gap-4 text-center">
                <div class="glass-card rounded-xl p-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mx-auto mb-2 text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" /></svg>
                    <h4 class="font-bold text-sm">AI 상권분석</h4>
                </div>
                 <div class="glass-card rounded-xl p-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mx-auto mb-2 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v.01" /></svg>
                    <h4 class="font-bold text-sm">맞춤 지원 정책</h4>
                </div>
                 <div class="glass-card rounded-xl p-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mx-auto mb-2 text-orange-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>
                    <h4 class="font-bold text-sm">실행 전략 제시</h4>
                </div>
            </div>
        </header>

        <main class="space-y-20 md:space-y-24">

            <section class="glass-card rounded-2xl p-8 text-center animate-on-scroll">
                <h2 class="text-2xl font-bold mb-3 leading-relaxed">사장님, 혹시 이런 고민 하고 계신가요?</h2>
                <div class="space-y-4 text-left my-6">
                    <div class="flex items-start space-x-3">
                        <svg class="w-6 h-6 text-blue-400 shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        <p class="text-slate-300">매출은 자꾸 떨어지는데, <span class="font-semibold text-white">정확한 원인</span>을 몰라 답답해요.</p>
                    </div>
                    <div class="flex items-start space-x-3">
                         <svg class="w-6 h-6 text-blue-400 shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        <p class="text-slate-300">정부 지원이 많다던데, <span class="font-semibold text-white">나에게 맞는 정책</span>을 찾기가 너무 어려워요.</p>
                    </div>
                    <div class="flex items-start space-x-3">
                        <svg class="w-6 h-6 text-blue-400 shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        <p class="text-slate-300">주변 상권은 어떻게 변하는지, <span class="font-semibold text-white">경쟁 가게</span>는 얼마나 늘었는지 감도 안 잡혀요.</p>
                    </div>
                </div>
                <p class="text-3xl font-extrabold text-blue-400 mb-2">이제 '함께가게' 하세요!</p>
                <p class="text-slate-300">사장님의 복잡한 고민, 저희가 데이터로 해결해 드릴게요.</p>
            </section>

            <section class="py-10 animate-on-scroll">
                <div class="text-center mb-6">
                    <h2 class="text-3xl font-extrabold mt-3 mb-2">모든 지원 정보를 한 곳에서!</h2>
                    <p class="text-slate-400">'함께가게'는 기관별로 흩어져 있던 정부 정책,<br>금융 상품을 통합하여 안내하는 플랫폼입니다.</p>
                </div>
                
                <div class="relative w-full overflow-hidden h-10">
                    <div class="marquee-content">
                        <div class="text-slate-500 font-bold text-xl mx-8">소상공인24</div>
                        <div class="text-slate-500 font-bold text-xl mx-8">기업마당</div>
                        <div class="text-slate-500 font-bold text-xl mx-8">금융위원회</div>
                        <div class="text-slate-500 font-bold text-xl mx-8">한국전력공사</div>
                        <div class="text-slate-500 font-bold text-xl mx-8">신용보증기금</div>
                        <div class="text-slate-500 font-bold text-xl mx-8">IBK기업은행</div>
                        <div class="text-slate-500 font-bold text-xl mx-8">소상공인365</div>
                        <div class="text-slate-500 font-bold text-xl mx-8">소상공인24</div>
                        <div class="text-slate-500 font-bold text-xl mx-8">기업마당</div>
                        <div class="text-slate-500 font-bold text-xl mx-8">금융위원회</div>
                        <div class="text-slate-500 font-bold text-xl mx-8">한국전력공사</div>
                        <div class="text-slate-500 font-bold text-xl mx-8">신용보증기금</div>
                        <div class="text-slate-500 font-bold text-xl mx-8">IBK기업은행</div>
                        <div class="text-slate-500 font-bold text-xl mx-8">소상공인365</div>
                    </div>
                </div>
            </section>

            <section id="diagnosis-report" class="animate-on-scroll">
                <div class="text-center mb-6">
                    <span class="bg-blue-900/80 text-blue-300 text-sm font-semibold px-3 py-1 rounded-full">핵심 기능 1</span>
                    <h2 class="text-3xl font-extrabold mt-3 mb-2">AI 진단 리포트</h2>
                    <p class="text-slate-400">내 가게의 현재 상태를 데이터로 정확히 분석하고<br>나아갈 방향을 제시합니다.</p>
                </div>
                
                <div class="glass-card rounded-2xl p-6">
                    <div class="border-b border-slate-700/50 pb-4 mb-6">
                        <h3 class="text-lg font-bold">우리가게 진단 리포트 (2025년 1분기)</h3>
                        <p class="text-sm text-slate-400">서울 성수동 A카페</p>
                        <p class="text-xs text-slate-500 mt-1">* 상세 설명을 위한 가상의 가게 정보입니다.</p>
                    </div>

                    <div class="relative overflow-hidden" id="report-slider-container">
                        <div class="flex transition-transform duration-500 ease-in-out" id="slider-track">
                            <div class="w-full flex-shrink-0 px-2 slide">
                                <div class="report-section">
                                    <h4 class="report-section-title"><i class="fa-solid fa-chart-pie"></i>우리가게 성장 유형</h4>
                                    <div class="growth-matrix">
                                        <div class="status">⚠️ 성장 정체 구간</div>
                                        <p class="description">안정적인 매출 대비 수익성 개선이 필요한 시점입니다.</p>
                                    </div>
                                </div>
                                <div class="report-section mt-6">
                                    <h4 class="report-section-title"><i class="fa-solid fa-arrow-right-arrow-left"></i>주요 변동 요인 분석</h4>
                                    <p class="text-xs text-slate-500 -mt-3 mb-3 text-left">(직전분기 대비)</p>
                                    <div class="factors-chart">
                                        <div class="factor-bar"><div class="factor-label">신규 고객 유입</div><div class="factor-bar-bg"><div class="factor-bar-fill positive" data-width="75" data-value="+15%"></div></div></div>
                                        <div class="factor-bar"><div class="factor-label">재방문율</div><div class="factor-bar-bg"><div class="factor-bar-fill positive" data-width="60" data-value="+8%"></div></div></div>
                                        <div class="factor-bar"><div class="factor-label">인근 경쟁강도</div><div class="factor-bar-bg"><div class="factor-bar-fill negative" data-width="80" data-value="-20%"></div></div></div>
                                        <div class="factor-bar"><div class="factor-label">재료비 원가</div><div class="factor-bar-bg"><div class="factor-bar-fill negative" data-width="65" data-value="-12%"></div></div></div>
                                    </div>
                                </div>
                            </div>
                            <div class="w-full flex-shrink-0 px-2 slide">
                                <div class="report-section">
                                    <h4 class="report-section-title"><i class="fa-solid fa-compass-drafting"></i>상권 건전성 지수</h4>
                                    <div class="radar-chart-container">
                                        <canvas id="radarChart"></canvas>
                                    </div>
                                    <div class="radar-legend">
                                        <div class="legend-item"><span class="legend-color" style="background-color: rgba(74, 144, 226, 0.8);"></span>성수동 연무장길</div>
                                        <div class="legend-item text-slate-500"><span class="legend-color" style="background-color: #6b7280;"></span>서울시 평균</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button id="prev-slide" class="absolute top-1/2 left-0 -translate-y-1/2 bg-slate-700/50 hover:bg-slate-600/50 rounded-full w-8 h-8 text-white transition-opacity duration-300 opacity-0"><i class="fa-solid fa-chevron-left"></i></button>
                        <button id="next-slide" class="absolute top-1/2 right-0 -translate-y-1/2 bg-slate-700/50 hover:bg-slate-600/50 rounded-full w-8 h-8 text-white transition-opacity duration-300"><i class="fa-solid fa-chevron-right"></i></button>
                    </div>
                    
                    <div id="slider-dots" class="flex justify-center gap-2 pt-4">
                    </div>

                    <div class="report-section mt-6 pt-6 border-t border-slate-700/50">
                        <h4 class="report-section-title"><i class="fa-solid fa-robot"></i>AI 종합 진단</h4>
                        <button id="gemini-analysis-btn" class="w-full bg-blue-500 text-white font-bold py-3 px-4 rounded-lg cta-button flex items-center justify-center gap-2">
                            ✨ AI 컨설턴트 분석 보기
                        </button>
                        <div id="ai-response-box" class="mt-4" style="display: none;">
                            <div id="ai-loader" class="flex items-center gap-3 text-sm text-blue-300 p-4 bg-slate-900/70 rounded-lg">
                                <i class="fa-solid fa-spinner fa-spin"></i>
                                <span>AI 컨설턴트가 데이터를 분석하고 있습니다...</span>
                            </div>
                            <div id="ai-summary-container" class="ai-summary" style="display: none;">
                                <div class="icon"><i class="fa-solid fa-lightbulb"></i></div>
                                <p id="ai-response-text"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="animate-on-scroll">
                <div class="text-center mb-6">
                    <span class="bg-blue-900/80 text-blue-300 text-sm font-semibold px-3 py-1 rounded-full">핵심 기능 2</span>
                    <h2 class="text-3xl font-extrabold mt-3 mb-2">AI 맞춤 정책 추천</h2>
                    <p class="text-slate-400">더 이상 놓치는 지원 정책 없도록!</p>
                </div>
                <div class="glass-card rounded-2xl p-6">
                     <h3 class="font-bold text-lg mb-4 text-white">AI 진단에 따른 맞춤 솔루션</h3>
                     <div class="space-y-4">
                        <div class="bg-slate-800/50 p-4 rounded-lg flex items-center space-x-4">
                                <div class="w-[56px] h-[56px] bg-purple-500 text-white rounded-lg flex items-center justify-center flex-shrink-0">
                                    <i class="fa-solid fa-wifi text-xl"></i>
                                </div>
                                <div>
                                    <h3 class="font-bold text-white">소상공인 스마트기술 도입 지원</h3>
                                    <p class="text-sm text-slate-400">CRM 도입, 온라인 마케팅 등 디지털 전환 비용 지원</p>
                                </div>
                            </div>

                            <div class="bg-slate-800/50 p-4 rounded-lg flex items-center space-x-4">
                                <div class="w-[56px] h-[56px] bg-blue-500 text-white rounded-lg flex items-center justify-center flex-shrink-0">
                                    <i class="fa-solid fa-bolt-lightning text-xl"></i> </div>
                                <div>
                                    <h3 class="font-bold text-white">소상공인 전기요금 특별지원</h3>
                                    <p class="text-sm text-slate-400">에너지 비용 부담 완화로 운영비 절감</p>
                                </div>
                            </div>
                        
                     </div>
                     <p class="text-center text-slate-400 mt-6">
                        진단 결과에 따라 <span class="font-semibold text-slate-200">가장 적합한 정책만 골라</span><br>새 공고가 뜨면 카카오톡으로 바로 알려드려요.
                        <p class="text-center text-sm text-slate-500 mt-1">* 정책 알림받기 신청 시 (출시 예정)</p>
                     </p>
                </div>
            </section>

            <section id="apply" class="text-center p-8 bg-blue-900/50 rounded-2xl text-white animate-on-scroll border border-blue-800">
                <h2 class="text-2xl font-extrabold mb-2">지금 바로<br>성공의 기회를 잡으세요!</h2>
                <p class="text-s text-slate-400 mb-4">출시까지</p>
                <div class="grid grid-cols-4 gap-2 sm:gap-4 max-w-xs mx-auto mb-8">
                    <div class="bg-slate-900/50 p-2 sm:p-3 rounded-lg text-center">
                        <div id="days" class="text-3xl sm:text-4xl font-bold">0</div>
                        <div class="text-xs sm:text-sm text-slate-400 mt-1">일</div>
                    </div>
                    <div class="bg-slate-900/50 p-2 sm:p-3 rounded-lg text-center">
                        <div id="hours" class="text-3xl sm:text-4xl font-bold">0</div>
                        <div class="text-xs sm:text-sm text-slate-400 mt-1">시간</div>
                    </div>
                    <div class="bg-slate-900/50 p-2 sm:p-3 rounded-lg text-center">
                        <div id="minutes" class="text-3xl sm:text-4xl font-bold">0</div>
                        <div class="text-xs sm:text-sm text-slate-400 mt-1">분</div>
                    </div>
                    <div class="bg-slate-900/50 p-2 sm:p-3 rounded-lg text-center">
                        <div id="seconds" class="text-3xl sm:text-4xl font-bold">0</div>
                        <div class="text-xs sm:text-sm text-slate-400 mt-1">초</div>
                    </div>
                </div>
                <p class="mb-8 opacity-80">
                    복잡한 고민은 저희에게 맡기시고,<br>사장님은 사업에만 집중하세요.
                </p>
                <a href="https://forms.gle/pXZiqrfdseMKmwpg6" target="_blank" rel="noopener noreferrer" class="cta-button inline-block bg-blue-500 text-white font-bold py-4 px-8 rounded-lg text-lg">
                    출시 알림 신청하기 <i class="fa-solid fa-rocket ml-2"></i>
                </a>
            </section>
        </main>

        <footer class="text-center py-6 text-slate-500 text-sm border-t border-slate-800 animate-on-scroll">
            &copy; 2025 함께가게. All Rights Reserved.
        </footer>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Add scroll effect to header
            const header = document.getElementById('main-header');
            if (header) {
                window.addEventListener('scroll', () => {
                    if (window.scrollY > 10) {
                        header.classList.add('scrolled');
                    } else {
                        header.classList.remove('scrolled');
                    }
                });
            }

            // Handles scroll animations for elements
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('in-view');
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.25 });

            document.querySelectorAll('.animate-on-scroll').forEach(el => {
                observer.observe(el);
            });

            // Starts the countdown timer
            function startCountdown() {
                // 출시일 설정: 2025년 11월 1일 오전 10시 (KST)
                const launchDate = new Date('2025-08-31T10:00:00+09:00');

                const timer = setInterval(() => {
                    const now = new Date();
                    const distance = launchDate.getTime() - now.getTime();
                    
                    if (distance < 0) {
                        clearInterval(timer);
                        document.getElementById('days').textContent = '0';
                        document.getElementById('hours').textContent = '00';
                        document.getElementById('minutes').textContent = '00';
                        document.getElementById('seconds').textContent = '00';
                        return;
                    }
                    document.getElementById('days').textContent = Math.floor(distance / (1000 * 60 * 60 * 24));
                    document.getElementById('hours').textContent = String(Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60))).padStart(2,'0');
                    document.getElementById('minutes').textContent = String(Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60))).padStart(2,'0');
                    document.getElementById('seconds').textContent = String(Math.floor((distance % (1000 * 60)) / 1000)).padStart(2,'0');
                }, 1000);
            }
            startCountdown();

            // Manages the report slider functionality
            const sliderContainer = document.getElementById('report-slider-container');
            if (sliderContainer) {
                const sliderTrack = document.getElementById('slider-track');
                const slides = Array.from(sliderTrack.children);
                const nextButton = document.getElementById('next-slide');
                const prevButton = document.getElementById('prev-slide');
                const dotsNav = document.getElementById('slider-dots');
                
                let currentIndex = 0;
                const animatedSlides = new Set();
                
                // Create navigation dots for each slide
                slides.forEach((_, i) => {
                    const dot = document.createElement('button');
                    dot.classList.add('slider-dot');
                    dot.addEventListener('click', () => moveToSlide(i));
                    dotsNav.appendChild(dot);
                });
                const dots = Array.from(dotsNav.children);

                // Moves the slider to a specific slide index
                const moveToSlide = (targetIndex) => {
                    const slide = slides[targetIndex];
                    if(slide) {
                        sliderContainer.style.height = slide.scrollHeight + 'px';
                        sliderTrack.style.transform = 'translateX(-' + slide.offsetLeft + 'px)';
                        currentIndex = targetIndex;
                        updateNav();
                        triggerSlideAnimations(targetIndex);
                    }
                };
                
                // Updates navigation buttons and dots based on the current slide
                const updateNav = () => {
                    dots.forEach(dot => dot.classList.remove('active'));
                    dots[currentIndex].classList.add('active');
                    prevButton.style.opacity = currentIndex === 0 ? '0' : '1';
                    prevButton.disabled = currentIndex === 0;
                    nextButton.style.opacity = currentIndex === slides.length - 1 ? '0' : '1';
                    nextButton.disabled = currentIndex === slides.length - 1;
                };

                // Triggers animations for a slide the first time it becomes visible
                const triggerSlideAnimations = (index) => {
                    if (animatedSlides.has(index)) return;

                    let animationTriggered = false;
                    if (index === 0) { animateFactorBars(); animationTriggered = true; } 
                    else if (index === 1) { createRadarChart(); animationTriggered = true; }
                    
                    if(animationTriggered) {
                        animatedSlides.add(index);
                        setTimeout(() => {
                            if (currentIndex === index) {
                                sliderContainer.style.height = slides[index].scrollHeight + 'px';
                            }
                        }, 150);
                    }
                };

                nextButton.addEventListener('click', () => {
                    if (currentIndex < slides.length - 1) moveToSlide(currentIndex + 1);
                });
                prevButton.addEventListener('click', () => {
                    if (currentIndex > 0) moveToSlide(currentIndex - 1);
                });
                
                // Initialize slider on page load
                setTimeout(() => {
                    sliderContainer.style.height = slides[0].scrollHeight + 'px';
                    updateNav();
                    triggerSlideAnimations(0);
                }, 100);

                // Adjust slider on window resize
                window.addEventListener('resize', () => {
                    const newTransform = slides[currentIndex].offsetLeft;
                    sliderTrack.style.transition = 'none';
                    sliderTrack.style.transform = `translateX(-${newTransform}px)`;
                    sliderContainer.style.height = slides[currentIndex].scrollHeight + 'px';
                    setTimeout(() => {
                        sliderTrack.style.transition = 'transform 0.5s ease-in-out';
                    }, 50);
                });
            }

            // Creates the radar chart using Chart.js
            function createRadarChart() {
                const ctx = document.getElementById('radarChart');
                if (!ctx || Chart.getChart(ctx)) return; // Don't re-create chart
                new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: ['과밀 지수', '상권 건전성', '재무 불안정'],
                        datasets: [
                            { label: '성수동 연무장길', data: [85, 45, 35], backgroundColor: 'rgba(74, 144, 226, 0.4)', borderColor: 'rgba(74, 144, 226, 1)', borderWidth: 2 },
                            { label: '서울시 평균', data: [55, 65, 60], backgroundColor: 'rgba(107, 114, 128, 0.4)', borderColor: 'rgba(107, 114, 128, 1)', borderWidth: 2, borderDash: [5, 5] }
                        ]
                    },
                    options: {
                        animation: { duration: 1500, easing: 'easeOutQuart' },
                        scales: { r: { angleLines: { color: 'rgba(255, 255, 255, 0.2)' }, grid: { color: 'rgba(255, 255, 255, 0.2)' }, pointLabels: { font: { size: 12, weight: 'bold' }, color: '#E0E1DD' }, ticks: { display: false }, min: 0, max: 100 } },
                        plugins: { legend: { display: false } },
                        maintainAspectRatio: false
                    }
                });
            }

            // Animates the width of the factor bars
            function animateFactorBars() {
                const bars = document.querySelectorAll('.factor-bar-fill');
                bars.forEach(bar => {
                    setTimeout(() => {
                        bar.style.width = bar.dataset.width + '%';
                        bar.textContent = bar.dataset.value;
                    }, 300);
                });
            }

            // Simulates a typewriter effect for displaying text
            function typeWriter(element, text, onComplete) {
                let i = 0;
                element.innerHTML = '';
                function type() {
                    if (i < text.length) {
                        element.innerHTML += text.charAt(i);
                        i++;
                        setTimeout(type, 25);
                    } else if (onComplete) {
                        onComplete();
                    }
                }
                type();
            }

            // Simulates calling the Gemini API
            async function callGeminiAPI() {
                console.log("Simulating Gemini API Call");
                await new Promise(resolve => setTimeout(resolve, 1500));
                return "사장님, 안녕하세요! 함께가게 AI 컨설턴트입니다. 현재 사장님 가게는 안정적 상권에 있지만, 과도한 경쟁으로 수익성이 악화되고 있습니다. 가격 경쟁 대신 운영 효율화로 체질을 개선해야 합니다. 정부의 '소상공인 스마트기술 도입 지원'을 신청해 보세요. 키오스크나 고객 관리(CRM) 시스템 도입으로 비용을 절감하고, 확보된 단골 고객은 성장의 돌파구가 될 겁니다.";
            }
            
            const analysisBtn = document.getElementById('gemini-analysis-btn');

            if (analysisBtn) {
                analysisBtn.addEventListener('click', async () => {
                    const responseBox = document.getElementById('ai-response-box');
                    const loader = document.getElementById('ai-loader');
                    const summaryContainer = document.getElementById('ai-summary-container');
                    const responseText = document.getElementById('ai-response-text');

                    analysisBtn.style.display = 'none';
                    responseBox.style.display = 'block';
                    loader.style.display = 'flex';
                    summaryContainer.style.display = 'none';
                    
                    const result = await callGeminiAPI();
                    
                    loader.style.display = 'none';
                    summaryContainer.style.display = 'flex';
                    
                    typeWriter(responseText, result, null); // No callback needed anymore
                });
            }
        });
    </script>
</body>
</html>
